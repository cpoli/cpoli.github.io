

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lieb_tb &mdash; Tight-Binding Lieb  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Tight-Binding Lieb  documentation" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index_lieb.html" class="fa fa-home"> Tight-Binding Lieb</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../lieb_tb.html">lieb_tb module</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_lieb.html">Tight-Binding Lieb</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_lieb.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Module code</a> &raquo;</li>
      
    <li>lieb_tb</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for lieb_tb</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="kn">as</span> <span class="nn">sparse</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="kn">as</span> <span class="nn">LA</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">import</span> <span class="nn">numpy.random</span> <span class="kn">as</span> <span class="nn">rand</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="kn">import</span> <span class="n">exp</span> <span class="k">as</span> <span class="n">cexp</span>  
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="kn">as</span> <span class="nn">animation</span>


<div class="viewcode-block" id="latticeTB"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.latticeTB">[docs]</a><span class="k">class</span> <span class="nc">latticeTB</span><span class="p">():</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	The class latticeTB build up a lattice.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">pv</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		:param tags: The tags (one char) associated to each sublattice.</span>
<span class="sd">		:param ri: Initial positions of sites belonging to the unit cell.</span>
<span class="sd">		:param pv: Primitive vectors.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">tags</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c"># no sites along x and y</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ri</span> <span class="o">=</span> <span class="n">ri</span>  <span class="c"># initial positions of the sites[[0, 0], [1, 0], [0, 1]]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pv</span> <span class="o">=</span> <span class="n">pv</span>  <span class="c"># primitive vectors		</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">],</span> <span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;f8&#39;</span><span class="p">,</span> <span class="s">&#39;f8&#39;</span><span class="p">,</span> <span class="s">&#39;S1&#39;</span><span class="p">]})</span>

<div class="viewcode-block" id="latticeTB.get_lattice"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.latticeTB.get_lattice">[docs]</a>	<span class="k">def</span> <span class="nf">get_lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the lattice positions</span>
<span class="sd">		</span>
<span class="sd">		:param nx: Number of sites along x.</span>
<span class="sd">		:param ny: Number of sites along y.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">):</span>
			<span class="n">x_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ri</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">y_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ri</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">x_tag</span><span class="p">,</span> <span class="n">y_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_tag</span><span class="p">,</span> <span class="n">y_tag</span><span class="p">)</span>
			<span class="n">x_tag</span><span class="p">,</span> <span class="n">y_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">x_tag</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_tag</span><span class="p">)</span>
			<span class="n">coor_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_tag</span><span class="p">),</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">],</span> <span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;f8&#39;</span><span class="p">,</span> <span class="s">&#39;f8&#39;</span><span class="p">,</span> <span class="s">&#39;S1&#39;</span><span class="p">]})</span>
			<span class="n">coor_tag</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_tag</span>
			<span class="n">coor_tag</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_tag</span>
			<span class="n">coor_tag</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">coor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">,</span> <span class="n">coor_tag</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coor</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="eigTB"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigTB">[docs]</a><span class="k">class</span> <span class="nc">eigTB</span><span class="p">():</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Solve the Tigh Binding eigenvalue problem of a lattice defined using the class latticeTB.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coor</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		:param coor: Sites coordinates (output of the class **latticeTB**).</span>
<span class="sd">		:param tags: Sites tags (input of the class **latticeTB**).</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">tags</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coor</span> <span class="o">=</span> <span class="n">coor</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">],</span> <span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">]})</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ham</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">vn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="s">&#39;f8&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">pola</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tags</span><span class="p">)))</span>

<div class="viewcode-block" id="eigTB.get_ham"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigTB.get_ham">[docs]</a>	<span class="k">def</span> <span class="nf">get_ham</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the Tight-Binding Hamiltonian.</span>

<span class="sd">		:param on: Onsite energies of the sublattices</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">)</span>
		<span class="n">onsite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">):</span>
    			<span class="n">onsite</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">o</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ham</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">],</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">])),</span> 
										<span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">))</span> \
				   <span class="o">+</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">],</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">])),</span> 
				   						<span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">))</span> \
				   <span class="o">+</span> <span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">onsite</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="eigTB.get_eig"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigTB.get_eig">[docs]</a>	<span class="k">def</span> <span class="nf">get_eig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the eigenergies, eigenvectors and polarisations of the Tight-Binding model.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">en</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vn</span>  <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ham</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">en</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">en</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">en</span> <span class="p">[</span><span class="n">ind</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">vn</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vn</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vn</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tags</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">pola</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">intensity</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
							<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">)]</span>
</div>
<div class="viewcode-block" id="eigTB.get_state_pola"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigTB.get_state_pola">[docs]</a>	<span class="k">def</span> <span class="nf">get_state_pola</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the state with the maximal polarization on one sublattice.</span>

<span class="sd">		:param tag: Tag of the sublattice.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">i_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">tags</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">bytes_</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pola</span><span class="p">[:,</span> <span class="n">i_tag</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s">&#39;Selected State with polarization:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pola</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">i_tag</span><span class="p">])</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>

</div></div>
<div class="viewcode-block" id="eigLieb"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb">[docs]</a><span class="k">class</span> <span class="nc">eigLieb</span><span class="p">(</span><span class="n">eigTB</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Child of the class **eigTB**. Dedicated to the Lieb lattice. </span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coor</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
		<span class="n">eigTB</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coor</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># disorder strength</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># next nearest hoppings strength </span>

<div class="viewcode-block" id="eigLieb.get_hop_uni"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.get_hop_uni">[docs]</a>	<span class="k">def</span> <span class="nf">get_hop_uni</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the nearest hoppings of the Lieb lattice and set their values to :math:`t`</span>
<span class="sd">		and, get the next nearest hoppings (diagonal hoppings)</span>
<span class="sd">		and set their values to :math:`c t`.</span>

<span class="sd">		:param t: Nearest hopping value.</span>
<span class="sd">		:param c: Next nearest hopping strength.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
		<span class="n">dif_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">dif_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">dis</span> <span class="o">=</span> <span class="n">dif_x</span> <span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dif_y</span> <span class="o">**</span><span class="mi">2</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">dis</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">],</span> 
									     		<span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">]})</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span>
		<span class="n">ind_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">dis</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">hop_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_nn</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">],</span>
                 								     <span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">]})</span>
		<span class="n">hop_nn</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_nn</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop_nn</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_nn</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="n">hop_nn</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">,</span> <span class="n">hop_nn</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="eigLieb.get_hop_alt"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.get_hop_alt">[docs]</a>	<span class="k">def</span> <span class="nf">get_hop_alt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
		<span class="sd">r&#39;&#39;&#39;</span>
<span class="sd">		Get the nearest hoppings of the Lieb lattice with alternating hoppings</span>
<span class="sd">		and, the next nearest hoppings. As the  next nearest hoppings are </span>
<span class="sd">		diagonal hoppings, the value of the diagonal between :math:`t_1` </span>
<span class="sd">		and :math:`t_2` is given by </span>

<span class="sd">		.. math::</span>

<span class="sd">			c\sqrt{t_1^2+t_22} \, .</span>

<span class="sd">		:param ta: Value of the math:`t_{ab}` hoppings.</span>
<span class="sd">		:param tb: Value of the math:`t_{ba}` hoppings.</span>
<span class="sd">		:param tc: Value of the math:`t_{ac}` hoppings.</span>
<span class="sd">		:param td: Value of the math:`t_{ca}` hoppings.</span>
<span class="sd">		:param c: Default value 0, strength of the diagonal hoppings.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">dif_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">dif_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">ind_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">dif_x</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dif_y</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span>
		<span class="n">hop_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">],</span> 
											 <span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">,</span> <span class="s">&#39;S2&#39;</span><span class="p">]})</span>
		<span class="n">hop_x</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop_x</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="n">hop_x</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="n">ind_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]][</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;ab&#39;</span><span class="p">,</span> <span class="s">&#39;ba&#39;</span><span class="p">)</span>
		<span class="n">hop_x</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">hop_x</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ab&#39;</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>

		<span class="n">ind_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">dif_x</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dif_y</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span>
		<span class="n">hop_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">],</span> 
											 <span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">,</span> <span class="s">&#39;S2&#39;</span><span class="p">]})</span>
		<span class="n">hop_y</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop_y</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="n">hop_y</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="n">ind_y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]][</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;ac&#39;</span><span class="p">,</span> <span class="s">&#39;ca&#39;</span><span class="p">)</span>
		<span class="n">hop_y</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">hop_y</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">td</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hop_x</span><span class="p">,</span> <span class="n">hop_y</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">hop_nn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hop_alt_nn</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">,</span> <span class="n">hop_nn</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="eigLieb.get_hop_alt_nn"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.get_hop_alt_nn">[docs]</a>	<span class="k">def</span> <span class="nf">get_hop_alt_nn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the next nearest hoppings if the Lieb lattice has alternating hoppings. </span>
<span class="sd">		Method used in **get_hop_alt**.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
		<span class="n">hop_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">],</span>
                 						<span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">,</span> <span class="s">&#39;S2&#39;</span><span class="p">]})</span>
		<span class="n">dif_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">dif_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">dif_x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dif_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
		<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
		<span class="n">ind_ord</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
		<span class="n">hop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;names&#39;</span><span class="p">:[</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="s">&#39;j&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">],</span>
                 					<span class="s">&#39;formats&#39;</span><span class="p">:[</span><span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;u4&#39;</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">,</span> <span class="s">&#39;S2&#39;</span><span class="p">]})</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]):</span>
			<span class="n">td</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
		     		 		 <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
			<span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)]</span>  <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">td</span>
		<span class="n">hop_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hop_nn</span><span class="p">,</span> <span class="n">hop</span><span class="p">])</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">dif_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dif_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
		<span class="n">ind_ord</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]):</span>

			<span class="n">td</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
		     		 		 <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
			<span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)]</span>  <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">td</span>
			
		<span class="n">hop_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hop_nn</span><span class="p">,</span> <span class="n">hop</span><span class="p">])</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">dif_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dif_y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="n">ind_ord</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]):</span>
			<span class="n">td</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span><span class="o">+</span>
		     		  		 <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
			<span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)]</span>  <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">td</span>
		<span class="n">hop_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hop_nn</span><span class="p">,</span> <span class="n">hop</span><span class="p">])</span>
		<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">dif_x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dif_y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="n">ind_ord</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
		<span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_ord</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind_ord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]):</span>
			<span class="n">td</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
		     		  	 	 <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
			<span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">)]</span>  <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">td</span>
		<span class="n">hop_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hop_nn</span><span class="p">,</span> <span class="n">hop</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">hop_nn</span>
</div>
<div class="viewcode-block" id="eigLieb.set_dim_defect"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.set_dim_defect">[docs]</a>	<span class="k">def</span> <span class="nf">set_dim_defect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim_x</span><span class="p">,</span> <span class="n">dim_y</span><span class="p">,</span> <span class="n">along_x</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">along_y</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Set dimerization defects along :math:`x` and/or :math:`y`.</span>

<span class="sd">		:param dim_x: Dimerization along :math:`x` site index.</span>
<span class="sd">		:param dim_x: Dimerization along :math:`y` site index.</span>
<span class="sd">		:param along_x: Default value False. Introduce a dimerization defect along :math:`x`.</span>
<span class="sd">		:param along_y: Default value False. Introduce a dimerization defect along :math:`y`.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">ta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">tb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ba&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">tc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ca&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">along_x</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ab&#39;</span><span class="p">)</span> <span class="o">&amp;</span> 
						<span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">dim_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tb</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ba&#39;</span><span class="p">)</span> <span class="o">&amp;</span> 
						<span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span>  <span class="o">&gt;=</span> <span class="n">dim_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ta</span>
		<span class="k">if</span> <span class="n">along_y</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">)</span> <span class="o">&amp;</span> 
						<span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">dim_y</span><span class="p">)]</span> <span class="o">=</span> <span class="n">td</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ca&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
						<span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span>  <span class="o">&gt;=</span> <span class="n">dim_y</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tc</span>
</div>
<div class="viewcode-block" id="eigLieb.disorder_generic"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.disorder_generic">[docs]</a>	<span class="k">def</span> <span class="nf">disorder_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Set a generic disorder. </span>

<span class="sd">		:param alpha: Default value 0. Stength of the disorder.</span>

<span class="sd">		.. note::</span>

<span class="sd">			This disorder destroys the zero mode.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">1</span><span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">rand</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</div>
<div class="viewcode-block" id="eigLieb.disorder_uniform"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.disorder_uniform">[docs]</a>	<span class="k">def</span> <span class="nf">disorder_uniform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Set a disorder uniform along math:`y` for math:`t_{ab}`  and math:`t_{ba}`,  </span>
<span class="sd">		and uniform along math:`x` for math:`t_{ac}`  and math:`t_{ca}`.</span>

<span class="sd">		:param alpha: Default value 0. Stength of the disorder.</span>

<span class="sd">		.. note::</span>

<span class="sd">			This disorder preserves the zero mode.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">rand_x</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">rand</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="n">rand_y</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">rand</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ab&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ba&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
						 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">y</span><span class="p">)]</span> <span class="o">*=</span> <span class="n">rand_x</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ca&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
						 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">x</span><span class="p">)]</span> <span class="o">*=</span> <span class="n">rand_y</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</div>
<div class="viewcode-block" id="eigLieb.disorder_pair"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.disorder_pair">[docs]</a>	<span class="k">def</span> <span class="nf">disorder_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Set a non uniform disorder.</span>

<span class="sd">		:param alpha: Default value 0. Stength of the disorder.</span>

<span class="sd">		.. note::</span>

<span class="sd">			This disorder preserves the zero mode.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
			<span class="n">rand_x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">rand</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
			<span class="n">rand_x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand_x</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ab&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ba&#39;</span><span class="p">))</span> <span class="o">&amp;</span> 
						 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">y</span><span class="p">)]</span> <span class="o">*=</span> <span class="n">rand_x</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
			<span class="n">rand_y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">rand</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
			<span class="n">rand_y</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand_y</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ca&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
				 		 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">x</span><span class="p">)]</span> <span class="o">*=</span> <span class="n">rand_y</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</div>
<div class="viewcode-block" id="eigLieb.disorder_plaquette"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.disorder_plaquette">[docs]</a>	<span class="k">def</span> <span class="nf">disorder_plaquette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Set a non uniform disorder.</span>

<span class="sd">		:param alpha: Default value 0. Stength of the disorder.</span>

<span class="sd">		.. note::</span>

<span class="sd">			This disorder preserves the zero mode.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">1</span><span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">rand</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]))</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)]:</span> 
			<span class="n">hop_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">i</span><span class="o">*</span><span class="n">lx</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
							    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
						   	    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">j</span><span class="o">*</span><span class="n">ly</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
						   	    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ly</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
				  			    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">i</span><span class="o">*</span><span class="n">lx</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
				  			    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
				  		   	    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">j</span><span class="o">*</span><span class="n">ly</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span>
				  		   	    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ly</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">])]</span> <span class="o">=</span> \
				<span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span> <span class="o">/</span> \
				<span class="p">(</span><span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">hop_p</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</div>
<div class="viewcode-block" id="eigLieb.magnetic_field"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.eigLieb.magnetic_field">[docs]</a>	<span class="k">def</span> <span class="nf">magnetic_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Add Pierls phases to the hoppings.</span>

<span class="sd">		:param nx: Number of sites along math:`x`. (Input of the class **latticeTB**)</span>

<span class="sd">		.. note::</span>

<span class="sd">			This disorder preserves the zero mode.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][((</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ca&#39;</span><span class="p">))</span> 
				<span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">x</span><span class="p">)]</span> <span class="o">*=</span> \
				<span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">flux</span> <span class="o">*</span> <span class="n">x</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="plotTB"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.plotTB">[docs]</a><span class="k">class</span> <span class="nc">plotTB</span><span class="p">:</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Plot the output of the class **latticeTB** and the class **eigTB**.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coor</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
		<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coor</span> <span class="o">=</span> <span class="n">coor</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">tags</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="plotTB.plt_lattice"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.plotTB.plt_lattice">[docs]</a>	<span class="k">def</span> <span class="nf">plt_lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hop</span><span class="o">=</span><span class="p">[],</span> <span class="n">ms</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">numero</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		:param hop: Default value []. Hoppings given by the class **eigTB**. </span>
<span class="sd">			If not empty, plot the hoppings.</span>
<span class="sd">		:param ms: Default value 30. Markersize. </span>
<span class="sd">		:param lw: Default value 5. Linewidth of the hoppings.</span>
<span class="sd">		:param fs: Default value 20. Fontsize.</span>
<span class="sd">		:param numero: Default value True. Plot the numero associated to each site.</span>
<span class="sd">		:param save: Default value False. Save the figure. </span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="c"># bonds</span>
		<span class="k">if</span> <span class="n">hop</span> <span class="o">!=</span> <span class="p">[]:</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hop</span><span class="p">)):</span> 
				<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]],</span>
                 			  	<span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]],</span>
                 			  	<span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
		<span class="c"># sites</span>
		<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
		    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">t</span><span class="p">],</span>
				    <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">t</span><span class="p">],</span>
				    <span class="s">&#39;o&#39;</span><span class="o">+</span><span class="n">c</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">])</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> 
					  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> 
					  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
		<span class="c"># numeros</span>
		<span class="k">if</span> <span class="n">numero</span><span class="p">:</span>
			<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]))]</span>
			<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]):</span>
			    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
							<span class="n">textcoords</span> <span class="o">=</span> <span class="s">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s">&#39;right&#39;</span><span class="p">,</span>
							<span class="n">va</span> <span class="o">=</span> <span class="s">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">fig</span>
</div>
<div class="viewcode-block" id="plotTB.plt_spec"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.plotTB.plt_spec">[docs]</a>	<span class="k">def</span> <span class="nf">plt_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="n">pola</span><span class="o">=</span><span class="p">[],</span> <span class="n">pola_tag</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	 	Plot the spectrum (real part of the eigenenergies (blue circles), </span>
<span class="sd">	 	and the polarization on the A sublattice (red circles).</span>

<span class="sd">		:param en: Eigenenergies.</span>
<span class="sd">		:param pola: Defaut value []. Output of the class **eigTB**.</span>
<span class="sd">		:param pola_tag: Tag of the sublattice.</span>
<span class="sd">		:param ms: Default value 10. Markersize.</span>
<span class="sd">	 	:param fs: Default value 20. Fontsize.</span>
<span class="sd">		:param save: Default value False. Save the figure. </span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">en</span><span class="p">))</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">en</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">ms</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;SPECTRUM AND POLARIZATION&#39;</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Spectrum and polarization&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$E_n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
		<span class="n">en_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">en</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">en_max</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">en_max</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
		<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
		    	<span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="n">pola_tag</span><span class="p">:</span>
			<span class="n">i_tag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">tags</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">bytes_</span><span class="p">(</span><span class="n">pola_tag</span><span class="p">))</span>
			<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">pola</span><span class="p">[:,</span> <span class="n">i_tag</span><span class="p">]),</span> <span class="s">&#39;or&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">ms</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
			<span class="n">ylabel</span> <span class="o">=</span> <span class="s">&#39;$&lt;&#39;</span> <span class="o">+</span> <span class="n">pola_tag</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;|&#39;</span> <span class="o">+</span> <span class="n">pola_tag</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;&gt;$&#39;</span> 
			<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
			<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
				<span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">fig</span>
</div>
<div class="viewcode-block" id="plotTB.plt_intensity"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.plotTB.plt_intensity">[docs]</a>	<span class="k">def</span> <span class="nf">plt_intensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Plot the intensity of a state.</span>

<span class="sd">		:param intensity: Intensity.</span>
<span class="sd">		:param s: Default value 300. Shape.</span>
<span class="sd">		:param fs: Default value 20. Font size.</span>
<span class="sd">		:param add: Default value &#39;&#39;. Give an additional file description.</span>
<span class="sd">		:param save: Default value False. Save the figure in the repertory given</span>
<span class="sd">			by the methop_nn *dir_name* with name given by the methop_nn *file_name*.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s">&#39;Sublattice polarized state(s)&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$j$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;$|\psi_n|^2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
		<span class="n">map_red</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;Reds&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">intensity</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">map_red</span><span class="p">)</span>
		<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">intensity</span><span class="p">)])</span>
		<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">])</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">fig</span>
</div>
<div class="viewcode-block" id="plotTB.plt_lieb_hop"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.plotTB.plt_lieb_hop">[docs]</a>	<span class="k">def</span> <span class="nf">plt_lieb_hop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hop</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Plot the coordinates of  the Lieb lattice sites in hoppings space.</span>

<span class="sd">		:param hop: Hoppings.</span>
<span class="sd">		:param nx: Number of sites along :math:`x`.</span>
<span class="sd">		:param ny: Number of sites along :math:`y`.	</span>
<span class="sd">		:param ms: Default value 20. Markersize.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
		<span class="n">coor_dis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">)</span>
		<span class="c"># coordinates at the bottom </span>
		<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span> <span class="n">nx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][:</span> <span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
		<span class="c"># coordinates at the left </span>
		<span class="n">ty</span> <span class="o">=</span> <span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][((</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ac&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ca&#39;</span><span class="p">))</span> <span class="o">&amp;</span> \
				  <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))]</span><span class="o">.</span><span class="n">real</span>
		<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ty</span><span class="p">)</span>
		<span class="c"># loop over each plaquette</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">)]:</span> 
			<span class="n">ind_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">i</span><span class="o">*</span><span class="n">lx</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> \
						   			<span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">j</span><span class="o">*</span><span class="n">ly</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ly</span><span class="o">+</span><span class="mf">0.1</span><span class="p">))</span>
			<span class="n">ind_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ind_r</span><span class="p">)</span>
			<span class="n">cond_h</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">i</span><span class="o">*</span><span class="n">lx</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> \
					   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">j</span><span class="o">*</span><span class="n">ly</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ly</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> \
					   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">i</span><span class="o">*</span><span class="n">lx</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> \
				  	   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">j</span><span class="o">*</span><span class="n">ly</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">]]</span><span class="o">&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ly</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
			<span class="n">hop_p</span> <span class="o">=</span> <span class="n">hop</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="n">cond_h</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
			<span class="n">tx0</span><span class="p">,</span> <span class="n">tx1</span><span class="p">,</span> <span class="n">tx2</span><span class="p">,</span> <span class="n">tx3</span> <span class="o">=</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
			<span class="n">ty0</span><span class="p">,</span> <span class="n">ty2</span><span class="p">,</span> <span class="n">ty1</span><span class="p">,</span> <span class="n">ty3</span> <span class="o">=</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">hop_p</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> 

			<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
				<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> 
				 <span class="n">tx2</span><span class="o">+</span><span class="n">tx3</span><span class="p">,</span> <span class="n">ty2</span><span class="o">+</span><span class="n">ty3</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
				<span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">WARNING WARNING WARNING&#39;</span><span class="p">)</span>
				<span class="k">print</span><span class="p">(</span><span class="s">&#39;Lattice construction in hopping space is not possible.&#39;</span><span class="p">)</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Run again or decrease the strength &#39;</span>
								  <span class="s">&#39;of the disorder.</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>

			<span class="n">ang_x</span><span class="p">,</span> <span class="n">ang_y</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">equations</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">p</span><span class="p">,))</span>
			<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">=</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">+</span> <span class="n">ty2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>
			<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">=</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">+</span> <span class="n">ty2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>
			<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">=</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="o">+</span> <span class="n">tx2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ang_x</span><span class="p">)</span>
			<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">=</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="o">+</span> <span class="n">tx2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ang_x</span><span class="p">)</span> 
			<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">=</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">+</span> <span class="n">ty3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span> 
			<span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">=</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">ind_r</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">+</span> <span class="n">ty3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>

		<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hop</span><span class="p">)):</span> 
				<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]],</span>
                 			  	<span class="p">[</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">hop</span><span class="p">[</span><span class="s">&#39;j&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]],</span>
                 			  	<span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
		        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">t</span><span class="p">],</span>
		                    <span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">][</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;tag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">t</span><span class="p">],</span>
		                    <span class="s">&#39;o&#39;</span><span class="o">+</span><span class="n">c</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">)</span>
		<span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">])</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">])</span><span class="o">+</span><span class="mf">1.5</span><span class="p">]</span>
		<span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coor_dis</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span><span class="o">+</span><span class="mf">1.5</span><span class="p">]</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">fig</span>
</div></div>
<div class="viewcode-block" id="propagationTB"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.propagationTB">[docs]</a><span class="k">class</span> <span class="nc">propagationTB</span><span class="p">():</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Time evolution.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coor</span><span class="p">,</span> <span class="n">sites</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Plot the coordinates of  the Lieb lattice sites in hoppings space.</span>

<span class="sd">		:param coor: Sites coordinates. Output of the class **latticeTB**.</span>
<span class="sd">		:param sites: Number of sites. Output of the class **latticeTB**.</span>
<span class="sd">		:param steps: Number of steps.</span>
<span class="sd">		:param dz: Step.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coor</span> <span class="o">=</span> <span class="n">coor</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sites</span> <span class="o">=</span> <span class="n">sites</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="n">dz</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">sites</span><span class="p">,</span> <span class="n">steps</span><span class="p">),</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="propagationTB.get_prop"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.propagationTB.get_prop">[docs]</a>	<span class="k">def</span> <span class="nf">get_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ham</span><span class="p">,</span> <span class="n">psi_init</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the time evolution.</span>

<span class="sd">		:param ham: Tight-Binding Hamilonian.</span>
<span class="sd">		:param psi_init: Initial state.</span>
<span class="sd">		:param norm: Default value True. Normalize the norm to 1 at each step.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">psi_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">psi_init</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_init</span>
		<span class="n">diag</span> <span class="o">=</span> <span class="mi">1j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">*</span> <span class="n">ham</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
		<span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">*</span> <span class="n">ham</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
		<span class="n">mat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="propagationTB.get_pump"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.propagationTB.get_pump">[docs]</a>	<span class="k">def</span> <span class="nf">get_pump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hams</span><span class="p">,</span> <span class="n">psi_init</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the time evolution under adiabatic pumpings.</span>

<span class="sd">		:param hams: Tight-Binding Hamilonians.</span>
<span class="sd">		:param psi_init: Initial state.</span>
<span class="sd">		:param norm: Default value True. Normalize the norm to 1 at each step.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">psi_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">psi_init</span><span class="p">])</span>
		<span class="n">no</span><span class="p">,</span> <span class="o">=</span> <span class="n">hams</span><span class="o">.</span><span class="n">shape</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_init</span>
		<span class="n">diag</span> <span class="o">=</span> <span class="mi">1j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="s">&#39;c16&#39;</span><span class="p">)</span>
		<span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">//</span><span class="p">(</span><span class="n">no</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="s">&#39;delta&#39;</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
		<span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">*</span> <span class="n">hams</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
		<span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">*</span> <span class="n">hams</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
		<span class="n">mat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
		
		<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">no</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
				<span class="n">ham</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">hams</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">hams</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">*</span> <span class="n">ham</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
				<span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">*</span> <span class="n">ham</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
				<span class="n">mat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="p">))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> \
						<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>		
		<span class="n">j</span> <span class="o">=</span> <span class="n">no</span>
		<span class="n">delta_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">-</span> <span class="n">no</span><span class="o">*</span><span class="n">delta</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">delta_f</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="n">j</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="n">j</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="n">j</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">[:,</span>  <span class="n">j</span><span class="o">*</span><span class="n">delta</span><span class="o">+</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="propagationTB.get_ani"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.propagationTB.get_ani">[docs]</a>	<span class="k">def</span> <span class="nf">get_ani</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the Time evolution animation.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="kn">import</span> <span class="nn">os</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;posix&#39;</span><span class="p">:</span>
			<span class="n">blit</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">blit</span> <span class="o">=</span> <span class="bp">True</span>
		<span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="p">)</span> 
		<span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">real</span>
		<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
		<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">color</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">color</span><span class="p">)]</span>
		<span class="n">scat</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
						   <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
						   <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;seismic&#39;</span><span class="p">))</span>
		<span class="n">frame</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
		<span class="n">frame</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
		<span class="n">frame</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
		<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">)</span>
		<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">])</span>
		<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">,</span>
                                  					  <span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">scat</span><span class="p">),</span> <span class="n">blit</span><span class="o">=</span><span class="n">blit</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">ani</span>
</div>
<div class="viewcode-block" id="propagationTB.update"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.propagationTB.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">scat</span><span class="p">):</span>
	    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	    Used to build up the animation.</span>
<span class="sd">	    &quot;&quot;&quot;</span>
	    <span class="n">scat</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">color</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
	    <span class="k">return</span> <span class="n">scat</span><span class="p">,</span>
</div></div>
<div class="viewcode-block" id="equations"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.equations">[docs]</a><span class="k">def</span> <span class="nf">equations</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the intersection of the points at the extremity of two segments.</span>
<span class="sd">    Used to build up the lattice in hopping space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span>
    <span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">la</span><span class="p">,</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">param</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xa</span><span class="o">+</span><span class="n">la</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ta</span><span class="p">)</span><span class="o">-</span><span class="n">xb</span><span class="o">-</span><span class="n">lb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">tb</span><span class="p">),</span>
            <span class="n">ya</span><span class="o">+</span><span class="n">la</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ta</span><span class="p">)</span><span class="o">-</span><span class="n">yb</span><span class="o">-</span><span class="n">lb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">tb</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="saveFigTB"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.saveFigTB">[docs]</a><span class="k">class</span> <span class="nc">saveFigTB</span><span class="p">():</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Create a folder and save the figures obtained via **plotTB**</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">hop</span><span class="p">,</span> <span class="n">hop_tags</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sites</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">sites</span>
		<span class="k">print</span><span class="p">(</span><span class="s">&#39;TAGS&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">tags</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">on</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">alpha</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">c</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop_tags</span> <span class="o">=</span> <span class="n">hop_tags</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hop</span> <span class="o">=</span> <span class="n">hop</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dir_main</span> <span class="o">=</span> <span class="s">&#39;figs/&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">()</span>

<div class="viewcode-block" id="saveFigTB.dir_name"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.saveFigTB.dir_name">[docs]</a>	<span class="k">def</span> <span class="nf">dir_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the name of the directory in which the figures </span>
<span class="sd">		are stored.</span>

<span class="sd">		:param add: String. First part of the directory name. </span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">dir_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_main</span> <span class="o">+</span> <span class="n">add</span> <span class="o">+</span> <span class="s">&#39;_n{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">dir_name</span>
</div>
<div class="viewcode-block" id="saveFigTB.check_dir"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.saveFigTB.check_dir">[docs]</a>	<span class="k">def</span> <span class="nf">check_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">			Create the directory to store the figures exists.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_main</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_main</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="saveFigTB.file_name"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.saveFigTB.file_name">[docs]</a>	<span class="k">def</span> <span class="nf">file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Create the last part of the file containing: the indices of the hopping</span>
<span class="sd">		defects (if any), the indices of the onsite enery defects (if any),</span>
<span class="sd">		the indices of the dimerization defects (if any),</span>
<span class="sd">		and the extension.</span>
<span class="sd">		</span>
<span class="sd">		:param add: String. First part of the file name. </span>

<span class="sd">		:returns:</span>
<span class="sd">			* **name** -- Last part of the file name.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">file_name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
		<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop_tags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop</span><span class="p">):</span> 
			<span class="n">file_name</span> <span class="o">+=</span> <span class="s">&#39;_&#39;</span><span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">h</span><span class="o">+</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">):</span> 
			<span class="n">file_name</span> <span class="o">+=</span> <span class="s">&#39;_e&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="n">o</span><span class="o">+</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
			<span class="n">file_name</span> <span class="o">+=</span>  <span class="s">&#39;_nn_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
			<span class="n">file_name</span> <span class="o">+=</span> <span class="s">&#39;_dis_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">file_name</span>
</div>
<div class="viewcode-block" id="saveFigTB.save_fig"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.saveFigTB.save_fig">[docs]</a>	<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Save the figure in the directory defined by the method *dir_name()*.</span>

<span class="sd">		:param fig: Matplotlib fig.</span>
<span class="sd">		:param name: Default value &#39;fig&#39;. Fist part of the file describing the figure,</span>
<span class="sd">			the ids used in the class are:</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">()</span>
		<span class="n">name_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">name_file</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="saveFigTB.save_ani"><a class="viewcode-back" href="../lieb_tb.html#lieb_tb.saveFigTB.save_ani">[docs]</a>	<span class="k">def</span> <span class="nf">save_ani</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ani</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Save the animation in the directory defined by the method *dir_name()*.</span>

<span class="sd">		:param ani: Matplotlib animation.</span>
<span class="sd">		:param name: Default value &#39;fig&#39;. Fist part of the file describing the figure,</span>
<span class="sd">			the ids used in the class are:</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">()</span>
		<span class="n">name_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;.mp4&#39;</span>
		<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">name_file</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">extra_args</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;-vcodec&#39;</span><span class="p">,</span> <span class="s">&#39;libx264&#39;</span><span class="p">])</span></div></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, cpoli.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>