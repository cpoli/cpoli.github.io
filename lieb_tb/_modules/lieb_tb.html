

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lieb_tb &mdash; lieb_tb  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
    <link rel="top" title="lieb_tb  documentation" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index_lieb.html" class="fa fa-home"> lieb_tb</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#motivations">Motivations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#feedback">Feedback</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../code.html#lieb-tb">lieb_tb</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#identical-hoppings">Identical hoppings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#identical-hoppings-with-an-impurity">Identical hoppings with an impurity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#alternative-hoppings">Alternative hoppings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#dimerization-defect-along-x">Dimerization defect along x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#dimerization-defect-along-x-and-y">Dimerization defect along x and y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#diagonal-hopping">Diagonal hopping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#hopping-disorder">Hopping disorder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#adiabatic-pumping">Adiabatic pumping</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_lieb.html">lieb_tb</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_lieb.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Module code</a> &raquo;</li>
      
    <li>lieb_tb</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for lieb_tb</h1><div class="highlight"><pre>
<span class="c"># !/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    lieb_tb</span>
<span class="sd">    ~~~~~~~</span>
<span class="sd">    </span>
<span class="sd">    The **lieb_tb** package models a two-dimensional face centered square </span>
<span class="sd">    lattice within the tight-binding framework. The hoppings and the onsite</span>
<span class="sd">    energies can be real and/or complex valued. Defects in the lattice can</span>
<span class="sd">    be introduced by modifying the hoppings.</span>
<span class="sd">    </span>
<span class="sd">    **lieb_tb** is available at https://github.com/cpoli/lieb_tb</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="kn">as</span> <span class="nn">sparse</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="kn">as</span> <span class="nn">la</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="kn">as</span> <span class="nn">animation</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c"># Absolute path of ffmpeg</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;animation.ffmpeg_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;/opt/local/bin/ffmpeg&#39;</span>


<div class="viewcode-block" id="lieb_tb"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb">[docs]</a><span class="k">class</span> <span class="nc">lieb_tb</span><span class="p">:</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    This is the only class of the **lieb_tb** package which contains </span>
<span class="sd">    all information for the square faced-centered lattice model.</span>
<span class="sd">    </span>
<span class="sd">    :param sites_x: Number of sites along the :math:`x` direction</span>
<span class="sd">      (positive integer).</span>
<span class="sd">    </span>
<span class="sd">    :param sites_y: Number of sites along the :math:`y` direction</span>
<span class="sd">      (positive integer).</span>
<span class="sd">        </span>
<span class="sd">    :param e_a: Onsite energies of the A sites (real or complex).</span>

<span class="sd">    :param e_b: Onsite energies of the B sites (real or complex).</span>

<span class="sd">    :param e_c: Onsite energies of the C sites (real or complex).</span>

<span class="sd">    :param t_x: List with two elements :math:`[t_{ab}, \, t_{ba}]`</span>
<span class="sd">      (real or complex). First element is the intradimer coupling</span>
<span class="sd">      connecting the A sites to the B sites. Second element is the</span>
<span class="sd">      intradimer coupling connecting the B sites to the A sites.</span>
<span class="sd">        </span>
<span class="sd">    :param t_y: List with two elements :math:`[t_{ac}, \, t_{ca}]`</span>
<span class="sd">      (real or complex). First element is the intradimer coupling</span>
<span class="sd">      connecting the A sites to the C sites. Second element is the</span>
<span class="sd">      intradimer coupling connecting the C sites to the A sites.</span>

<span class="sd">    :param diag_strength: Default value 0. Strength :math:`s` of the intracell</span>
<span class="sd">      cell diagonal hopping :math:`t_{cb}`.</span>
<span class="sd">      The diagonal hoppings are obtained through the distances</span>
<span class="sd">      :math:`d = e^{-2t}`</span>
<span class="sd">      :math:`d_{cb} = \sqrt{d_{ab}^2+d_{ac}^2}\, \qquad t_{cb} = -s\ln{d_{cb}}\, .`</span>
<span class="sd">    </span>
<span class="sd">    :param ext: Default value &#39;png&#39;. Extension of the figures to be saved.</span>
<span class="sd"> </span>
<span class="sd">    Example usage::</span>
<span class="sd">    </span>
<span class="sd">        # Creates a Lieb lattice with identical hoppings:</span>
<span class="sd">        lieb = lieb_tb(sites_x=14, sites_y=14, [1., 1.], [1., 1.])</span>

<span class="sd">        # Creates a Lieb lattice: alternating hoppings along x and y</span>
<span class="sd">        # and with intercell diagonal hoppings:</span>
<span class="sd">        lieb = lieb_tb(sites_x=17, sites_y=15, t_x=[2., 1.], t_y=[2., 3.-1j],</span>
<span class="sd">                       e_a=0j, e_b=-1j, e_c=-1j, diag_strength=0.1)</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sites_x</span><span class="p">,</span> <span class="n">sites_y</span><span class="p">,</span> <span class="n">t_x</span><span class="p">,</span> <span class="n">t_y</span><span class="p">,</span> <span class="n">e_a</span><span class="o">=</span><span class="mi">0j</span><span class="p">,</span> <span class="n">e_b</span><span class="o">=</span><span class="mi">0j</span><span class="p">,</span> <span class="n">e_c</span><span class="o">=</span><span class="mi">0j</span><span class="p">,</span>
                 <span class="n">diag_strength</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sites_x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sites_x</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument sites_x not a positive &#39;</span>
                            <span class="s">&#39;integer larger than 2.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sites_y</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sites_y</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument sites_x not a positive &#39;</span>
                            <span class="s">&#39;integer larger than 2.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e_a</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument e_a is not a number.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e_b</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument e_b is not a number.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e_c</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument e_c a is not number.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_x</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument t_x is an array with two numbers.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_y</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument t_y is an array with two numbers.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="c"># initialize the number of sites A and B along the x direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">=</span> <span class="n">sites_x</span>
        <span class="c"># initialize the number of sites A and C along the y direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span> <span class="o">=</span> <span class="n">sites_y</span>
        <span class="c"># initialize the number of bonds along the x direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span> <span class="o">=</span> <span class="n">sites_x</span><span class="o">-</span><span class="mi">1</span>
        <span class="c"># initialize the number of bonds along the y direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span> <span class="o">=</span> <span class="n">sites_y</span><span class="o">-</span><span class="mi">1</span>
        <span class="c"># initialize the onsite energies  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_a</span> <span class="o">=</span> <span class="n">e_a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_b</span> <span class="o">=</span> <span class="n">e_b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_c</span> <span class="o">=</span> <span class="n">e_c</span>
        <span class="c"># initialize the hoppings  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_ab</span> <span class="o">=</span> <span class="n">t_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_ba</span> <span class="o">=</span> <span class="n">t_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_ac</span> <span class="o">=</span> <span class="n">t_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_ca</span> <span class="o">=</span> <span class="n">t_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># initialize the strength of the disorder along both directions    </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_x</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_y</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis</span> <span class="o">=</span> <span class="s">&#39;no&#39;</span>
        <span class="c"># initialize the strength of the diagonal hoppings               </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diag_strength</span> <span class="o">=</span> <span class="n">diag_strength</span>
        <span class="c"># initialize the number of A sites along the x direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sites_x</span><span class="p">))</span>
        <span class="c"># initialize the number of A sites along the y direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sites_x</span><span class="p">))</span>
        <span class="c"># initialize the number of C sites along the x direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
        <span class="c"># initialize the number of A, B, and C sites along the x direction  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span> <span class="o">=</span> <span class="n">sites_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span>
        <span class="c"># initialize the number of A sites along the y direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sites_y</span><span class="p">))</span>
        <span class="c"># initialize the number of A sites along the y direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sites_y</span><span class="p">))</span>
        <span class="c"># initialize the number of A sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span>
        <span class="c"># initialize the number of B sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span>
        <span class="c"># initialize the number of C sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span>
        <span class="c"># initialize the number of A and B sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_a</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b</span>
        <span class="c"># initialize the number of A, B and C sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">+</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
        <span class="c"># initialize the indices associated to the A, B and C sublattices</span>
        <span class="c"># and the x and y coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind_a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind_b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_indices</span><span class="p">()</span>
        <span class="c"># initialize the onsite energies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onsite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_onsite</span><span class="p">()</span>
        <span class="c"># initialize the hoppings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_hop</span><span class="p">()</span>
        <span class="c">#  initialize all the hoppings</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="c"># store the indices of the hopping defects, onsite energy defects,</span>
        <span class="c"># and dimerization defects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_pump</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_name</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span>

        <span class="c"># PLOT VARIABLES</span>
        <span class="c"># label the sites (sites_label)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">))</span>
        <span class="c">#  initialize the x and y coordinates of the sites       </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coor_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_coordonates</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">)</span>

        <span class="c"># RESULTS</span>
        <span class="c"># initialize the tight-binding Hamiltonian</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ham</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="c"># initialize the eigenvalues of the Hamiltonian (eigenenergies {E_n})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="c"># initialize the squared modulus eigenvectors of the Hamiltonian</span>
        <span class="c"># (eigenenergies {|\psi_n|^2})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eig_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="c"># initialize the polarisation of the A sublattice ({|\psi_n^{A}|^2})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="c"># arrays containing the energy and the density of probability selected</span>
        <span class="c"># by a condition on the polarisation of A sublattice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_selec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_selec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">)</span>
        <span class="c"># array containing the time evolution of the field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<div class="viewcode-block" id="lieb_tb.set_indices"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_indices">[docs]</a>    <span class="k">def</span> <span class="nf">set_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the indices associated to the three sublattices. These indices</span>
<span class="sd">        are used to get the polarization, and to plot the lattice.</span>
<span class="sd">        The sites are labeled from left to right (along the x-axis) and</span>
<span class="sd">        from bottom to top (along the y-axis).</span>
<span class="sd">        </span>
<span class="sd">        Example usage::</span>
<span class="sd">        </span>
<span class="sd">            #Considering a Lieb lattice with sites_x=5 and sites_y=3,</span>
<span class="sd">            #the sites are labeled as:</span>
<span class="sd">            #</span>
<span class="sd">            # 8--9-10-11-12</span>
<span class="sd">            # |     |     |</span>
<span class="sd">            # 5     6     7</span>
<span class="sd">            # |     |     |</span>
<span class="sd">            # 0--1--2--3--4</span>
<span class="sd">            #</span>
<span class="sd">            #The indices of the A sublattice are: 0, 2, 4, 8, 10, 12.</span>
<span class="sd">            #The indices of the B sublattice are: 1, 3, 9, 11.</span>
<span class="sd">            #The indices of the C sublattice are: 5, 6, 7.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">ind_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
            <span class="n">ind_a_x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">+</span>
                            <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">ind_b_x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">+</span>
                            <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">ind_a</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_a_x</span>
            <span class="n">ind_b</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_b_x</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="p">):</span>
            <span class="n">ind_c_x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">ind_c</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="o">*</span><span class="n">i</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ind_c_x</span>

        <span class="k">return</span> <span class="n">ind_a</span><span class="p">,</span> <span class="n">ind_b</span><span class="p">,</span> <span class="n">ind_c</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_coordonates"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_coordonates">[docs]</a>    <span class="k">def</span> <span class="nf">set_coordonates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the (x,y) coordinates of the lattice sites A, B, and C sites.</span>
<span class="sd">        The center of mass of the lattice is set at the origin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coor_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">coor_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
            <span class="n">ind_a_x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">ind_b_x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">coor_x</span><span class="p">[</span><span class="n">ind_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">coor_y</span><span class="p">[</span><span class="n">ind_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span>
            <span class="n">coor_x</span><span class="p">[</span><span class="n">ind_b_x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">coor_y</span><span class="p">[</span><span class="n">ind_b_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="p">):</span>
            <span class="n">ind_c_x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">coor_x</span><span class="p">[</span><span class="n">ind_c_x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">coor_y</span><span class="p">[</span><span class="n">ind_c_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">coor_x</span><span class="p">[</span><span class="n">ind_c_x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">coor_y</span><span class="p">[</span><span class="n">ind_c_x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>

        <span class="n">x_center</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
        <span class="n">y_center</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span>
        <span class="n">coor_x</span> <span class="o">-=</span> <span class="n">x_center</span>
        <span class="n">coor_y</span> <span class="o">-=</span> <span class="n">y_center</span>
        <span class="k">return</span> <span class="n">coor_x</span><span class="p">,</span> <span class="n">coor_y</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_hop"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_hop">[docs]</a>    <span class="k">def</span> <span class="nf">set_hop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the hoppings. </span>
<span class="sd">        Used in the call of **lieb_tb** to set the hoppings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ba</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ca</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_onsite"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_onsite">[docs]</a>    <span class="k">def</span> <span class="nf">set_onsite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the onsite energies.</span>
<span class="sd">        Used in the call of **lieb_tb** to set the onsite energies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onsite</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_a</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onsite</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_b</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onsite</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_c</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_c</span>
</div>
<div class="viewcode-block" id="lieb_tb.display"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.display">[docs]</a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print on screen some information about the initial configuration of the lattice.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;---------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;report on tight-binding Lieb lattice&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;---------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites along x = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites along y = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites A along x  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites B along x  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites A along y  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of sites C along y  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;intradimer coupling t_ab  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ab</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;interdimer coupling t_ba  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ba</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;intradimer coupling t_ac  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ac</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;interdimer coupling t_ca  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ca</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;on-site energy A  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_a</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;on-site energy B  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_b</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;on-site energy C  = {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_c</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;indices of the modified hoppings along x:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;index {} val {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;indices of the modified hoppings along y:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;index {} val {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;indices of the dimerization defects:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;{} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;indices of the dimerization defects:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;{} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c">################################################################</span>
            <span class="c"># HOPPINGS HOPPINGS HOPPINGS HOPPINGS HOPPINGS HOPPINGS HOPPINGS</span>
            <span class="c">################################################################</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_def_hop_x"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_def_hop_x">[docs]</a>    <span class="k">def</span> <span class="nf">set_def_hop_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">hop_def</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change locally the values of the given hoppings in the AB chains.</span>
<span class="sd">            </span>
<span class="sd">        :param index: Array containing the indices of the bonds along :math:`x`.</span>
<span class="sd">            </span>
<span class="sd">        :param hop_def: values of the new hoppings.</span>
<span class="sd">            </span>
<span class="sd">        Example usage::</span>
<span class="sd">            </span>
<span class="sd">            lieb = lieb_tb(5, 3, [1., 1.], [1., 1.])</span>
<span class="sd">            #   A--B--A--B--A</span>
<span class="sd">            #   |     |     |</span>
<span class="sd">            #   C     C     C</span>
<span class="sd">            #   |     |     |</span>
<span class="sd">            #   A--B--A--B--A</span>
<span class="sd">            lieb.set_def_hop_x([0, 2], [2., 4.])</span>
<span class="sd">            # set all the 0th and the 3rd hoppings of the AB chains to 2 (++) and 4 (**):</span>
<span class="sd">            #   A++B--A--B**A</span>
<span class="sd">            #   |     |     |</span>
<span class="sd">            #   C     C     C</span>
<span class="sd">            #   |     |     |</span>
<span class="sd">            #   A++B--A--B**A</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hop_def</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments index and onsite_def must be arrays.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hop_def</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments index_defect and energy_defect &#39;</span>
                            <span class="s">&#39;must have same length.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">hop_def</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments in index are noy integers &#39;</span>
                                <span class="s">&#39;between 0 and (sites_x-2)\.n&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments in hop_def are not numbers.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span> <span class="o">+=</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_def_hop_y"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_def_hop_y">[docs]</a>    <span class="k">def</span> <span class="nf">set_def_hop_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">hop_def</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change locally the values of the given hoppings in the AC chains.</span>
<span class="sd">            </span>
<span class="sd">        :param index: Array containing the indices of the bonds along :math:`y`.</span>
<span class="sd">            </span>
<span class="sd">        :param hop_def: values of the new hoppings.</span>
<span class="sd">            </span>
<span class="sd">        Example usage::</span>
<span class="sd">            </span>
<span class="sd">            lieb = lieb_tb(5, 3, [1., 1.], [1., 1.])</span>
<span class="sd">            #   A--B--A--B--A</span>
<span class="sd">            #   |     |     |</span>
<span class="sd">            #   C     C     C</span>
<span class="sd">            #   |     |     |</span>
<span class="sd">            #   A--B--A--B--A</span>
<span class="sd">            lieb.set_def_hop_y([0, 1], [2., 4.])</span>
<span class="sd">            # set all the 0th and the 1st hoppings of the AC chains to 2 (+) and 4 (*):</span>
<span class="sd">            #   A--B--A--B--A</span>
<span class="sd">            #  *   *    *</span>
<span class="sd">            #   C     C     C</span>
<span class="sd">            #   +     +     +</span>
<span class="sd">            #   A--B--A--B--A</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hop_def</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments index and onsite_def must be arrays.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hop_def</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments index_defect and energy_defect &#39;</span>
                            <span class="s">&#39;must have same length.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">hop_def</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments in index are not integers &#39;</span>
                                <span class="s">&#39;between 0 and (sites_y-2)\.n&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments in hop_def are not numbers.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span> <span class="o">+=</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_def_dim_x"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_def_dim_x">[docs]</a>    <span class="k">def</span> <span class="nf">set_def_dim_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Introduce defects in the dimerization pattern in the AB chains</span>
<span class="sd">        by exchanging the interdimer hoppings with the extradimer hoppings</span>
<span class="sd">        starting from the ith bond (value(s) containing in *index*).</span>
<span class="sd">            </span>
<span class="sd">        :param index: Array containing the indices of the sites.</span>
<span class="sd">            </span>
<span class="sd">          .. note:: Dimerization defects start from the 3rd site (index = [2]).</span>
<span class="sd">            </span>
<span class="sd">          Example usage::</span>
<span class="sd">            </span>
<span class="sd">                lieb = lieb_tb(5, 3, [1., 1.], [1., 1.])</span>
<span class="sd">                #   A==B--A==B--A</span>
<span class="sd">                #   |           |</span>
<span class="sd">                #   C           C</span>
<span class="sd">                #   |           |</span>
<span class="sd">                #   A==B--A==B--A</span>
<span class="sd">                lieb.set_def_dimer_x([2])</span>
<span class="sd">                # introduce a dimerization defect starting from the 3rd site:</span>
<span class="sd">                #   A==B--A--B==A</span>
<span class="sd">                #   |           |</span>
<span class="sd">                #   C           C</span>
<span class="sd">                #   |           |</span>
<span class="sd">                #   A==B--A--B==A</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument index is not an array&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments index does not contain integers &#39;</span>
                                <span class="s">&#39;between 0 and (sites-2).</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">t_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">t_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span> <span class="o">+=</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="lieb_tb.set_def_dim_y"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.set_def_dim_y">[docs]</a>    <span class="k">def</span> <span class="nf">set_def_dim_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Introduce defects in the dimerization pattern in the AC chains</span>
<span class="sd">        (cf the method *set_def_dimer_x* for more details).</span>
<span class="sd">            </span>
<span class="sd">        :param index: Array containing the indices of the sites.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument index is not an array&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Arguments index does not contain &#39;</span>
                                <span class="s">&#39;integers between 0 and (sites-2).</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">t_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">t_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_c</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span> <span class="o">+=</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="lieb_tb.reset"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset the hopppings and the onsite energies to their initial values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_hop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_onsite</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_x</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_y</span> <span class="o">=</span> <span class="mf">0.</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_lattice_hop"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_lattice_hop">[docs]</a>    <span class="k">def</span> <span class="nf">get_lattice_hop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dis</span><span class="o">=</span><span class="s">&#39;no&#39;</span><span class="p">,</span> <span class="n">strength_x</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">strength_y</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Build, from hop_x and hop_y, the hoppings arrays used to get</span>
<span class="sd">        the Hamiltonian, the A and B matrices of the Crank-Nicolson</span>
<span class="sd">        algorithm (for time propagation). The disorder is also implemented</span>
<span class="sd">        via this method. In presence of disorder, the hoppings are changed in</span>
<span class="sd">        :math:`\tilde{t} \rightarrow t(1+\alpha)`, where :math:`\alpha` is a</span>
<span class="sd">        random number uniformly distributed between -strength/2 and strength/2.</span>

<span class="sd">        Example usage::</span>

<span class="sd">            #               Lieb plaquette</span>
<span class="sd">            #</span>
<span class="sd">            #               A--tx3--B--tx4--A</span>
<span class="sd">            #               |               |</span>
<span class="sd">            #              ty2             ty4</span>
<span class="sd">            #               |               |</span>
<span class="sd">            #               C               C</span>
<span class="sd">            #               |               |</span>
<span class="sd">            #              ty1             ty3</span>
<span class="sd">            #               |               |</span>
<span class="sd">            #               A--tx1--B--tx2--A</span>
<span class="sd">            #</span>
<span class="sd">            </span>
<span class="sd">        One can show that the energy of the zero-mode is protected</span>
<span class="sd">        if the hoppings satify the relation:</span>
<span class="sd">            </span>
<span class="sd">        .. math::</span>
<span class="sd">        </span>
<span class="sd">            \frac{t_{x_1} t_{x_4} t_{y_2} t_{y_3}}{t_{x_2}t_{x_3} t_{y_1} t_{y_4}} = 1\, .</span>
<span class="sd">                </span>
<span class="sd">        This can be achieved in many different ways, however just three ways</span>
<span class="sd">        are implemented to illustate that characteristic.</span>

<span class="sd">        :param strength_x: Default value 0. Strength of the disorder along x.</span>

<span class="sd">        :param strength_y: Default value 0. Strength of the disorder along y.</span>

<span class="sd">        :param dis: Default value &quot;no&quot;. Possible values are</span>
<span class="sd">            </span>
<span class="sd">            * &#39;no&#39;, no disorder.</span>
<span class="sd">                    </span>
<span class="sd">            * &#39;inv&#39;, :math:`\alpha_{x_1}`, :math:`\alpha_{x_2}`, :math:`\alpha_{y_1}`,</span>
<span class="sd">              and :math:`\alpha_{y_2}`, are random. The other :math:`\alpha` s</span>
<span class="sd">              are given by:</span>
<span class="sd">                </span>
<span class="sd">              .. math::</span>
<span class="sd">        </span>
<span class="sd">                \alpha_{x_3}= \alpha_{x_1}\,\quad\alpha_{x_4}=\alpha_{x_2}\,\quad \alpha_{y_3}= \alpha_{y_1}\,</span>
<span class="sd">                    \quad\alpha_{y_4}=\alpha_{y_2}.</span>
<span class="sd">                    </span>
<span class="sd">              This disorder imposes that :math:`t_{ab}` and :math:`t_{ba}` are</span>
<span class="sd">              invariant along y and :math:`t_{ac}` and :math:`t_{ca}` are</span>
<span class="sd">              invariant along x. The later identity is satisfyied,</span>
<span class="sd">              the zero-mode is then preserved.</span>
<span class="sd">                </span>
<span class="sd">            * &#39;pair&#39;, :math:`\alpha_{x_1}`, :math:`\alpha_{x_3}`, :math:`\alpha_{y_1}`,</span>
<span class="sd">              and :math:`\alpha_{y_4}`, are random.</span>
<span class="sd">              The other :math:`\alpha` s are given by:</span>
<span class="sd">                </span>
<span class="sd">              .. math::</span>
<span class="sd">                    </span>
<span class="sd">                \alpha_{x_2}= \alpha_{x_1}\, \quad \alpha_{x_4}= \alpha_{x_3}\, \quad</span>
<span class="sd">                \alpha_{y_2}= \alpha_{y_1}\, \quad \alpha_{y_4} = \alpha_{y_3}.</span>
<span class="sd">                        </span>
<span class="sd">              The later identity is satisfyied, the zero-mode is then preserved.</span>
<span class="sd">                    </span>
<span class="sd">            * &#39;octo&#39;, :math:`\alpha_{x_1}`, :math:`\alpha_{x_2}`, :math:`\alpha_{x_4}`,</span>
<span class="sd">              :math:`\alpha_{y_1}`, :math:`\alpha_{y_2}`, :math:`\alpha_{y_3}`, and</span>
<span class="sd">              :math:`\alpha_{y_4}` are random. :math:`\alpha_{x_3}` is fixed by:</span>

<span class="sd">              .. math::</span>
<span class="sd">                        </span>
<span class="sd">                \alpha_{x_3} = \frac{\alpha_{x_1} \alpha_{x_4} \, \alpha_{y_2} \alpha_{y_3} }{\alpha_{x_2}\, \alpha_{y_1} \alpha_{y_4}}</span>
<span class="sd">                </span>
<span class="sd">              This type of disorder preserves the existence of the zero mode.</span>
<span class="sd">                    </span>
<span class="sd">            * &#39;gen&#39;, a generic disorder, all the :math:`\alpha` s are random.</span>
<span class="sd">              This disorder destroys the protection of the energy of zero mode.</span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dis</span> <span class="o">==</span> <span class="s">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">strength_x</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">strength_y</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">dis</span> <span class="o">==</span> <span class="s">&#39;inv&#39;</span><span class="p">:</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">strength_x</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">strength_y</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_x</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">dis</span> <span class="o">==</span> <span class="s">&#39;pair&#39;</span><span class="p">:</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
                <span class="n">dis_x</span> <span class="o">=</span> <span class="n">strength_x</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">/</span><span class="mf">2.</span><span class="p">)))</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">hop_x</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">dis_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">hop_x</span><span class="p">[::</span><span class="mi">2</span><span class="p">])])</span>
                <span class="n">hop_x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">dis_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">hop_x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_x</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;here&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dis_y</span> <span class="o">=</span> <span class="n">strength_y</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="n">hop_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">dis_y</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_y</span>

        <span class="k">elif</span> <span class="n">dis</span> <span class="o">==</span> <span class="s">&#39;octo&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
                <span class="n">hop_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">strength_x</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_x</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">):</span>
                <span class="n">hop_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">strength_y</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_y</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">ix1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
                    <span class="n">ix2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
                    <span class="n">ix3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
                    <span class="n">ix4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>

                    <span class="n">tx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">ix1</span><span class="p">]</span>
                    <span class="n">tx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">ix2</span><span class="p">]</span>
                    <span class="n">tx3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">ix3</span><span class="p">]</span>
                    <span class="n">tx4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">ix4</span><span class="p">]</span>

                    <span class="n">iy1</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
                    <span class="n">iy2</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
                    <span class="n">iy3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
                    <span class="n">iy4</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>

                    <span class="n">ty1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">iy1</span><span class="p">]</span>
                    <span class="n">ty2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">iy2</span><span class="p">]</span>
                    <span class="n">ty3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">iy3</span><span class="p">]</span>
                    <span class="n">ty4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">iy4</span><span class="p">]</span>

                    <span class="n">tx3</span> <span class="o">=</span> <span class="p">(</span><span class="n">tx1</span><span class="o">*</span><span class="n">tx4</span><span class="o">*</span><span class="n">ty2</span><span class="o">*</span><span class="n">ty3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tx2</span><span class="o">*</span><span class="n">ty1</span><span class="o">*</span><span class="n">ty4</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">ix3</span><span class="p">]</span> <span class="o">=</span> <span class="n">tx3</span>

        <span class="k">elif</span> <span class="n">dis</span> <span class="o">==</span> <span class="s">&#39;gen&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
                <span class="n">hop_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">strength_x</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_x</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">):</span>
                <span class="n">hop_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">strength_y</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">:(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument dis takes five possible values: &#39;</span>
                            <span class="s">&#39;&quot;no&quot;, &quot;inv&quot;, &quot;pair&quot;, &quot;octo&quot;, or &quot;gen&quot;.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_x</span> <span class="o">=</span> <span class="n">strength_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_y</span> <span class="o">=</span> <span class="n">strength_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dis</span> <span class="o">=</span> <span class="n">dis</span>

    <span class="c">#######################################################</span>
    <span class="c"># EIGEN EIGEN EIGEN EIGEN EIGEN EIGEN EIGEN EIGEN EIGEN</span>
    <span class="c">#######################################################</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_eig"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_eig">[docs]</a>    <span class="k">def</span> <span class="nf">get_eig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Obtain the tight-binding Hamiltonian of the chain, solve the eigenvalue</span>
<span class="sd">        eigenvector problem :math:`H|\psi_n\rangle= E_n |\psi_n\rangle`, stores</span>
<span class="sd">        the eigenenergies :math:`{E_n}`, the probability densities of the eigenstates</span>
<span class="sd">        :math:`{|\psi_n|^2}`, and the eigenvector polarizations of the A sublattice</span>
<span class="sd">        :math:`{|\psi_n^{(A)}|^2}`.</span>
<span class="sd">            </span>
<span class="sd">        .. note:: </span>
<span class="sd">        </span>
<span class="sd">        The eigenenergies, probability densities, and A sublattice polarization,</span>
<span class="sd">        are stored in increasing order of the eigenenergy real part.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ham</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">()</span>
        <span class="n">en</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ham</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span> <span class="o">=</span> <span class="n">en</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eig_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vn</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_a</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_matrix"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">get_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_mat</span><span class="o">=</span><span class="s">&#39;ham&#39;</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Return the Hamiltonian or the A or B matrix used in the Cranck-Nicolson</span>
<span class="sd">        algorithm to get the time propagation.</span>
<span class="sd">            </span>
<span class="sd">        :param type_mat: Default value &#39;ham&#39;. String with values &#39;ham&#39; to get</span>
<span class="sd">            the Hamiltonian or, with value &#39;A&#39; or &#39;B&#39; to get the matrices A and B</span>
<span class="sd">            of the Cranck-Nicolson algorithm (propagation is given by</span>
<span class="sd">            :math:`psi_{n+1} = A^{-1} B psi_{n})`.</span>
<span class="sd">            </span>
<span class="sd">        :param dz: Default value 0.05. Time step of the propagation.</span>
<span class="sd">            </span>
<span class="sd">        .. note:: This method is essentially to be used in the methods,</span>
<span class="sd">            *get_eig*, *get_propagation*, and *get_pumping*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dz</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="n">dz</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument dz is not a positive float.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">type_mat</span> <span class="o">==</span> <span class="s">&#39;ham&#39;</span><span class="p">:</span>
            <span class="n">onsite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsite</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span>
        <span class="k">elif</span> <span class="n">type_mat</span> <span class="o">==</span> <span class="s">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">onsite</span> <span class="o">=</span> <span class="mi">1j</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">onsite</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span>
        <span class="k">elif</span> <span class="n">type_mat</span> <span class="o">==</span> <span class="s">&#39;B&#39;</span><span class="p">:</span>
            <span class="n">onsite</span> <span class="o">=</span> <span class="mi">1j</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dz</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">onsite</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument type_mat is not a string with values: &#39;</span>
                            <span class="s">&#39;&quot;ham&quot;, &quot;A&quot; or &quot;B&quot;.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="c"># t_{ab} and  t_{ba}  </span>
        <span class="n">diag_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
            <span class="n">diag_ab</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">:</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span>

        <span class="n">ham_x</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">([</span><span class="n">diag_ab</span><span class="p">,</span> <span class="n">onsite</span><span class="p">,</span> <span class="n">diag_ab</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="c"># t_{ac}  and  t_{ca}  </span>
        <span class="n">row_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">col_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">val_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>

        <span class="c"># t_{ac} </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">row_y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">col_y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">val_y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">:(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">]</span>

        <span class="c"># t_{ca} </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">row_y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span>
                               <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">col_y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span>
                               <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">val_y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">]</span>

        <span class="n">row_y</span><span class="p">,</span> <span class="n">col_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">row_y</span><span class="p">,</span> <span class="n">col_y</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">col_y</span><span class="p">,</span> <span class="n">row_y</span><span class="p">))</span>
        <span class="n">val_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">val_y</span><span class="p">,</span> <span class="n">val_y</span><span class="p">))</span>
        <span class="n">ham_y</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="n">val_y</span><span class="p">,</span> <span class="p">(</span><span class="n">col_y</span><span class="p">,</span> <span class="n">row_y</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diag_strength</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ham_x</span> <span class="o">+</span> <span class="n">ham_y</span>

        <span class="c"># t_{bc}</span>
        <span class="n">row_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">col_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">val_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_y</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">)</span>
            <span class="n">hop_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">:</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">hop_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="p">:</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_b_x</span><span class="p">]</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">hop_b</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">hop_c</span><span class="p">))</span>
            <span class="n">hop_diag</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">diag_strength</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

            <span class="n">row_d</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">col_d</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">val_d</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">hop_diag</span>

        <span class="n">row_d</span><span class="p">,</span> <span class="n">col_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">row_d</span><span class="p">,</span> <span class="n">col_d</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">col_d</span><span class="p">,</span> <span class="n">row_d</span><span class="p">))</span>
        <span class="n">val_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">val_d</span><span class="p">,</span> <span class="n">val_d</span><span class="p">))</span>
        <span class="n">ham_d</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="n">val_d</span><span class="p">,</span> <span class="p">(</span><span class="n">col_d</span><span class="p">,</span> <span class="n">row_d</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ham_x</span><span class="o">+</span><span class="n">ham_y</span><span class="o">+</span><span class="n">ham_d</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_states_selec"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_states_selec">[docs]</a>    <span class="k">def</span> <span class="nf">get_states_selec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s">&#39;max&#39;</span><span class="p">,</span> <span class="n">val_pola</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Get, if any, the eigenenergies and the probability densities selected</span>
<span class="sd">        through a condition on the  A sublattice polarization.</span>
<span class="sd">            </span>
<span class="sd">        :param selection: Default value &quot;max&quot;.</span>
<span class="sd">            String with values &quot;max&quot;, &quot;min&quot;, &quot;larger&quot;, or &quot;smaller&quot;.</span>

<span class="sd">            * &quot;max&quot; -- Stores in *energy_selec* and *density_selec*</span>
<span class="sd">                the maximal A polarized state.</span>
<span class="sd">                    </span>
<span class="sd">            * &quot;min&quot; -- Stores in *energy_selec* and *density_selec* the minimal A</span>
<span class="sd">                polarized state (maximal B polarized state).</span>
<span class="sd">                    </span>
<span class="sd">            * &quot;larger&quot; -- Stores in *energy_selec* the eigenenergies of the states</span>
<span class="sd">                satisfying :math:`\langle |\psi_n^{A} |^{2} \rangle` &gt; *val_pola*,</span>
<span class="sd">                and stores in *density_selec* the sum of the probability densities</span>
<span class="sd">                satisfying the same condition.</span>

<span class="sd">            * &quot;smaller&quot; -- Stores in *energy_selec* the eigenenergies of the states</span>
<span class="sd">                satisfying :math:`\langle |\psi_n^{A} |^{2} \rangle` &lt; *val_pola*,</span>
<span class="sd">                and stores in *density_selec* the sum of the probability densities</span>
<span class="sd">                satisfying the same condition.</span>
<span class="sd">                    </span>
<span class="sd">        :param val_pola: is the lower, higher bound when using the larger, smaller</span>
<span class="sd">            selection rule. Note that val_pola :math:`\in(0:1]`.</span>
<span class="sd">        </span>
<span class="sd">        Example usage::</span>
<span class="sd">        </span>
<span class="sd">            lieb = lieb_tb(9, 9, [2., 2.], [2., 2.])</span>
<span class="sd">            lieb.get_lattice_hop()</span>
<span class="sd">            lieb.eig()</span>
<span class="sd">            # the eigenenergies and eigenstates are required.</span>
<span class="sd">            lieb.get_states_selec()</span>
<span class="sd">            # finds one state of zero energy localized only on the A sublattice.</span>
<span class="sd">            lieb = lieb_tb(8, 8, [2., 2.], [2., 2.])</span>
<span class="sd">            lieb.get_lattice_hop()</span>
<span class="sd">            lieb.eig()</span>
<span class="sd">            lieb.get_states_selec()</span>
<span class="sd">            # finds no state.</span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_selec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_selec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_density</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Run the method eig() first.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val_pola</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">val_pola</span> <span class="o">&lt;=</span> <span class="mf">0.</span> <span class="ow">or</span> <span class="n">val_pola</span> <span class="o">&gt;=</span> <span class="mf">1.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument pola_a_min is not a float between 0 and 1.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">selection</span> <span class="o">==</span> <span class="s">&#39;max&#39;</span><span class="p">:</span>
            <span class="n">dump</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">dump</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">selection</span> <span class="o">==</span> <span class="s">&#39;min&#39;</span><span class="p">:</span>
            <span class="n">dump</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">dump</span><span class="p">]],</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="n">selection</span> <span class="o">==</span> <span class="s">&#39;smaller&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span> <span class="o">&lt;</span> <span class="n">val_pola</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">selection</span> <span class="o">==</span> <span class="s">&#39;larger&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span> <span class="o">&gt;</span> <span class="n">val_pola</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument selection must be a string: &#39;</span>
                            <span class="s">&#39;&quot;min&quot;, &quot;max&quot;, &quot;smaller&quot;, or &quot;larger&quot;.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;GET {} POLARIZED STATE(S):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_selec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">energy_selec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]]</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s"> Energy: ({0.real:.6f} {0.imag:.6f}j)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy_selec</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t\t</span><span class="s"> with Polarization {:.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">density_selec</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_density</span><span class="p">[:,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;NO POLARIZED STATES&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_propagation"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_propagation">[docs]</a>    <span class="k">def</span> <span class="nf">get_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi_init</span><span class="p">,</span> <span class="n">dz</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Obtain the time evolution of the field and store it.</span>
<span class="sd">        </span>
<span class="sd">        :param psi_init: Initial state.</span>
<span class="sd">        </span>
<span class="sd">        :param dz: Default value 0.05. Step in time.</span>
<span class="sd">        </span>
<span class="sd">        :param steps: Default value 200. Number of steps.</span>
<span class="sd">        </span>
<span class="sd">        :param norm: Default value True. Renormalize the intensity :math:`I_n`</span>
<span class="sd">            at each step :math:`n` such that :math:`|\psi(n)|^2=1`.</span>
<span class="sd">            The normalization, which does not hold if *e_a*, *e_b*,</span>
<span class="sd">            *t_a*, or *t_b* are complex variables, can useful in presence of</span>
<span class="sd">            amplification or to plot the time evolution.</span>
<span class="sd">        </span>
<span class="sd">        Example usage::</span>
<span class="sd">        </span>
<span class="sd">            lieb = lieb_tb(sites_x=9, sites_y=9, t_x=[2., 2.], t_x=[2., 2.],\</span>
<span class="sd">                           e_a=0.5j, e_b=-0.5j, e_c=-0.5j)</span>
<span class="sd">            lieb.get_lattice()</span>
<span class="sd">            # initial state uniformly distributed on all the sites</span>
<span class="sd">            psi_i = np.ones(lieb.sites)/lieb.sites</span>
<span class="sd">            lieb.propagation(psi_i)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="n">dz</span>
        <span class="n">mat_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">mat_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mat_a</span><span class="p">),</span> <span class="n">mat_b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">steps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">psi_init</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
            <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_pumping"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_pumping">[docs]</a>    <span class="k">def</span> <span class="nf">get_pumping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi_init</span><span class="p">,</span> <span class="n">lattice_hop_new_x</span><span class="p">,</span> <span class="n">lattice_hop_new_y</span><span class="p">,</span>
                    <span class="n">dz</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">steps_pump</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;max&#39;</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Obtain the time evolution of the system submitted to adiabatic</span>
<span class="sd">        modifications of the hopping configuration. The new hopping</span>
<span class="sd">        configurations are contained in the matrices hop_new_x and hop_new_y.</span>
<span class="sd">            </span>
<span class="sd">        The time evolution is split in three different parts:</span>
<span class="sd">            </span>
<span class="sd">            * Stationary time evolution in the initial hopping configuration</span>
<span class="sd">              (the one of the instance of class).</span>
<span class="sd">            * Transient time evolution going linearly from</span>
<span class="sd">              the initial hopping configuration to the new one.</span>
<span class="sd">            * Stationary time evolution in the new hopping configuration.</span>
<span class="sd">            </span>
<span class="sd">        .. note:: The last two parts of the time evolution is repeated</span>
<span class="sd">            :math:`n` times if hop_new contains :math:`n` hopping configurations.</span>
<span class="sd">            </span>
<span class="sd">        :param psi_init: Initial state.</span>
<span class="sd">            </span>
<span class="sd">        :param lattice_hop_new_x: List containing the hopping configurations</span>
<span class="sd">            along x in which the lattice will be.</span>

<span class="sd">        :param lattice_hop_new_y: List containing the hopping configurations</span>
<span class="sd">            along y in which the lattice will be.</span>

<span class="sd">        :param dz: Step in time.</span>

<span class="sd">        :param steps_pump: Number of steps during the transition.</span>
<span class="sd">            </span>
<span class="sd">        :param norm: Default value &#39;intensity&#39;. Normalize the probability density</span>
<span class="sd">          at each time step:</span>
<span class="sd">          </span>
<span class="sd">          * &#39;no&#39;: Does not renormalize.</span>
<span class="sd">          * &#39;intensity&#39;: renormalize according to :math:`|\psi(z)|^2=1`.</span>
<span class="sd">          * &#39;max&#39;: renormalize according to :math:`\text{max}[|\psi(z)|^2]=1`.</span>
<span class="sd">            </span>
<span class="sd">          .. note::</span>
<span class="sd">            </span>
<span class="sd">            The normalization, automatically performed in the Hermitian case,</span>
<span class="sd">            does not hold if *e_a*, *e_b*, *t_a*, or *t_b* are complex variables.</span>
<span class="sd">            The normalization can then be useful in presence of amplification and</span>
<span class="sd">            absorption for to plot the time evolution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dz</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">dz</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument dz is not a positive float.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps_pump</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">steps_pump</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument steps_pump is not a positive int.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">psi_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi_init</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument psi_init is not a numpy array of size sites.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">lattice_hop_new_x</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">lattice_hop_new_x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument hop_new_x is not composed of numpy arrays &#39;</span>
                            <span class="s">&#39;of size number of bonds alony x.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">lattice_hop_new_y</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">lattice_hop_new_y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument hop_new_y is not composed of numpy arrays &#39;</span>
                            <span class="s">&#39;of size number of bonds alony y.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">norm</span> <span class="o">!=</span> <span class="s">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">norm</span> <span class="o">!=</span> <span class="s">&#39;intensity&#39;</span> <span class="ow">and</span> <span class="n">norm</span> <span class="o">!=</span> <span class="s">&#39;max&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Argument norm is not &quot;no&quot;, &quot;intensity&quot;, or &quot;max&quot;.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="n">num_pump</span><span class="p">,</span> <span class="n">dump</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">lattice_hop_new_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">+</span><span class="n">num_pump</span><span class="p">)</span><span class="o">*</span><span class="n">steps_pump</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_pump</span> <span class="o">=</span> <span class="n">steps_pump</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="n">dz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([(</span><span class="n">num_pump</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">steps_pump</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">],</span>
                                   <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">psi_init</span>

        <span class="c"># before pumping</span>
        <span class="n">lattice_hop_save_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span>
        <span class="n">lattice_hop_save_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span>
        <span class="n">mat_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">mat_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mat_a</span><span class="p">),</span> <span class="n">mat_b</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps_pump</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
            <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s">&#39;intensity&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> \
                    <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s">&#39;max&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> \
                    <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

        <span class="c"># pumping</span>
        <span class="n">transition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">steps_pump</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pump</span><span class="p">):</span>
            <span class="n">lattice_hop_before_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span>
            <span class="n">lattice_hop_before_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="nb">range</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">steps_pump</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">steps_pump</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span> <span class="o">=</span> <span class="n">transition</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">*</span><span class="n">lattice_hop_new_x</span><span class="p">[:][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> \
                    <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">transition</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">*</span><span class="n">lattice_hop_before_x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span> <span class="o">=</span> <span class="n">transition</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">*</span><span class="n">lattice_hop_new_y</span><span class="p">[:][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> \
                    <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">transition</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span><span class="o">*</span><span class="n">lattice_hop_before_y</span>
                <span class="n">mat_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
                <span class="n">mat_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mat_a</span><span class="p">),</span> <span class="n">mat_b</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">val</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">val</span><span class="p">,</span> <span class="p">:])</span>
                <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s">&#39;intensity&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">val</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> \
                        <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">val</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s">&#39;max&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">val</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> \
                        <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">val</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

        <span class="c"># after pumping</span>
        <span class="n">mat_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">mat_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mat_a</span><span class="p">),</span> <span class="n">mat_b</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">num_pump</span><span class="p">)</span><span class="o">*</span><span class="n">steps_pump</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">num_pump</span><span class="p">)</span><span class="o">*</span><span class="n">steps_pump</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
            <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s">&#39;intensity&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s">&#39;max&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span> <span class="o">=</span> <span class="n">lattice_hop_save_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span> <span class="o">=</span> <span class="n">lattice_hop_save_y</span>

    <span class="c">#######################################################</span>
    <span class="c"># PLOTS PLOTS PLOTS PLOTS PLOTS PLOTS PLOTS PLOTS PLOTS</span>
    <span class="c">#######################################################</span>
</div>
<div class="viewcode-block" id="lieb_tb.plt_lattice"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.plt_lattice">[docs]</a>    <span class="k">def</span> <span class="nf">plt_lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">hop_space</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save_txt</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Plot the lattice sites in the hopping space. The A sublattice as blue circles,</span>
<span class="sd">        the B sublattice as red circles, and C sublattice as green circles.</span>
<span class="sd">            </span>
<span class="sd">        :param s: Default value 250. Area of each marker.</span>
<span class="sd">            </span>
<span class="sd">        :param hop_space: Default value True.</span>
<span class="sd">            If True, plot the lattice in hopping space.</span>
<span class="sd">            If False, plot the lattice in real space. A formula going</span>
<span class="sd">            from the hopping to the real space must be given, example:</span>
<span class="sd">            *hop_to_real_mw* for the microwave regime. (:math:`t\approx 1e7`)</span>
<span class="sd">            </span>
<span class="sd">        :param save: Default value False. Save the figure in the repertory</span>
<span class="sd">            given by the method *dir_name* with name given by the method *file_name*.</span>

<span class="sd">        .. note:: if size is too large (size_x and size_y &gt; 25)</span>
<span class="sd">            the resulting figure will not be so useful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.</span> <span class="ow">or</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Run the metod get_lattice_hop first</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">hop_space</span><span class="p">:</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="o">.</span><span class="n">real</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="o">.</span><span class="n">real</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hop_x</span> <span class="o">=</span> <span class="n">hop_to_real_mw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_x</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
            <span class="n">hop_y</span> <span class="o">=</span> <span class="n">hop_to_real_mw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice_hop_y</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">ix1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
                <span class="n">ix2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
                <span class="n">ix3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>
                <span class="n">ix4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span>

                <span class="n">tx1</span> <span class="o">=</span> <span class="n">hop_x</span><span class="p">[</span><span class="n">ix1</span><span class="p">]</span>
                <span class="n">tx2</span> <span class="o">=</span> <span class="n">hop_x</span><span class="p">[</span><span class="n">ix2</span><span class="p">]</span>
                <span class="n">tx3</span> <span class="o">=</span> <span class="n">hop_x</span><span class="p">[</span><span class="n">ix3</span><span class="p">]</span>
                <span class="n">tx4</span> <span class="o">=</span> <span class="n">hop_x</span><span class="p">[</span><span class="n">ix4</span><span class="p">]</span>

                <span class="n">iy1</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
                <span class="n">iy2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
                <span class="n">iy3</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>
                <span class="n">iy4</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span>

                <span class="n">ty1</span> <span class="o">=</span> <span class="n">hop_y</span><span class="p">[</span><span class="n">iy1</span><span class="p">]</span>
                <span class="n">ty2</span> <span class="o">=</span> <span class="n">hop_y</span><span class="p">[</span><span class="n">iy2</span><span class="p">]</span>
                <span class="n">ty3</span> <span class="o">=</span> <span class="n">hop_y</span><span class="p">[</span><span class="n">iy3</span><span class="p">]</span>
                <span class="n">ty4</span> <span class="o">=</span> <span class="n">hop_y</span><span class="p">[</span><span class="n">iy4</span><span class="p">]</span>

                <span class="c"># initialize the position of the first A site (bottom left one) at the origin</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

                <span class="n">i1</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">i3</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span>
                <span class="n">i4</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span>
                <span class="n">i5</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">i6</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span>
                <span class="n">i7</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">i8</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span>

                <span class="c"># positions of the A and B sites along x, at the bottom of the cell</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">+</span><span class="n">tx1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span><span class="o">+</span><span class="n">tx2</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span>

                <span class="c"># positions of the A and C sites along y, at the left of the cell</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">+</span><span class="n">ty1</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i4</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i4</span><span class="p">]</span><span class="o">+</span><span class="n">ty3</span>

                <span class="c"># parameters to obtain the positions of the rest of the sites</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i6</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i6</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i3</span><span class="p">],</span>
                     <span class="n">tx3</span><span class="o">+</span><span class="n">tx4</span><span class="p">,</span> <span class="n">ty2</span><span class="o">+</span><span class="n">ty4</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">WARNING WARNING WARNING&#39;</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Lattice construction in hopping space is not possible.&#39;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Run again or decrease the strength of the disorder.</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
                
                <span class="n">ang_x</span><span class="p">,</span> <span class="n">ang_y</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">equations</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">p</span><span class="p">,))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span><span class="o">+</span><span class="n">ty2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span><span class="o">+</span><span class="n">ty2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i5</span><span class="p">]</span><span class="o">+</span><span class="n">ty4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i5</span><span class="p">]</span><span class="o">+</span><span class="n">ty4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ang_y</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i6</span><span class="p">]</span><span class="o">+</span><span class="n">tx3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ang_x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i6</span><span class="p">]</span><span class="o">+</span><span class="n">tx3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ang_x</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> \
                    <span class="n">hop_x</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_x</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_c_x</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> \
                    <span class="n">hop_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds_y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s">&#39;LIEB LATTICE&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>

        <span class="c"># plot bonds</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_y</span><span class="p">):</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="s">&#39;k&#39;</span><span class="p">)</span>

        <span class="c"># plot sites</span>
        <span class="n">coor_ac_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span><span class="p">)</span>
        <span class="n">coor_ac_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_a_x</span><span class="p">):</span>
            <span class="n">ind_a</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">ind_c</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_abc_x</span><span class="p">)</span>
            <span class="n">coor_ac_x</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">ind_a</span><span class="p">]</span>
            <span class="n">coor_ac_y</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">ind_a</span><span class="p">]</span>
            <span class="n">coor_ac_x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="n">ind_c</span><span class="p">]</span>
            <span class="n">coor_ac_y</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="n">ind_c</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coor_ac_x</span><span class="p">,</span> <span class="n">coor_ac_y</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_a</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_b</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_b</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_c</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_c</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hop_space</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s">&#39;lattice_hop&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s">&#39;lattice_real&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_txt</span> <span class="ow">and</span> <span class="n">hop_space</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">()</span>
            <span class="n">name_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s">&#39;/lattice_real&#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;.txt&#39;</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">name_file</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_hop_y</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="lieb_tb.plt_spec"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.plt_spec">[docs]</a>    <span class="k">def</span> <span class="nf">plt_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the spectrum. The real part (blue circles) and imaginary part (red circles),</span>
<span class="sd">        if any, of the eigenenergies).</span>
<span class="sd">            </span>
<span class="sd">        :param markersize: size of the circles.</span>
<span class="sd">            </span>
<span class="sd">        :param fontsize: size of the font used for the axis labels and the title.</span>
<span class="sd">            </span>
<span class="sd">        :param save: Default value False. Save the figure in the repertory given by</span>
<span class="sd">            the method *dir_name* with name given by the method *file_name*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s">&#39;Spectrum&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$E_n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s">&#39;or&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">&#39;$\Re({E_n})$&#39;</span><span class="p">,</span> <span class="s">&#39;$\Im({E_n})$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s">&#39;spec&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="lieb_tb.plt_spec_pola"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.plt_spec_pola">[docs]</a>    <span class="k">def</span> <span class="nf">plt_spec_pola</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the spectrum. The real part (blue circles) and</span>
<span class="sd">        imaginary part (red circles), if any, of the eigenenergies).</span>
<span class="sd">            </span>
<span class="sd">        :param markersize: size of the circles.</span>
<span class="sd">            </span>
<span class="sd">        :param fontsize: size of the font used for the axis labels and the title.</span>
<span class="sd">            </span>
<span class="sd">        :param save: Default value False. Save the figure in the repertory</span>
<span class="sd">            given by the method *dir_name* with name given by the method *file_name*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s">&#39;Spectrum and Polarization&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$E_n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_energy</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
            <span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eig_pola</span><span class="p">,</span> <span class="s">&#39;or&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$&lt;A|A&gt;$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
            <span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s">&#39;spec_pola&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="lieb_tb.plt_states_selec"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.plt_states_selec">[docs]</a>    <span class="k">def</span> <span class="nf">plt_states_selec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the sum of the probability densities satisfying the condition</span>
<span class="sd">        imposed by the method get_states_cond.</span>
<span class="sd">            </span>
<span class="sd">        :param s: Area of the circular marker used to represent the intensity</span>
<span class="sd">            of the field at a given site.</span>

<span class="sd">        :param fontsize: size of the font used for the axis labels and the title.</span>

<span class="sd">        :param add: Default value &#39;&#39;. Give an additional file description.</span>

<span class="sd">        :param save: Default value False. Save the figure in the repertory given</span>
<span class="sd">            by the method *dir_name* with name given by the method *file_name*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_selec</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s">&#39;Sublattice polarized state(s)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$j$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;$|\psi_n|^2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">map_red</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;Reds&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">density_selec</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">map_red</span><span class="p">)</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density_selec</span><span class="p">)])</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">])</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s">&#39;states&#39;</span> <span class="o">+</span> <span class="n">add</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;NO POLARIZED STATES</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

<span class="c">#############################################################</span>
<span class="c"># ANIMATION ANIMATION ANIMATION ANIMATION ANIMATION ANIMATION</span>
<span class="c">#############################################################</span>
</div>
<div class="viewcode-block" id="lieb_tb.get_animation"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.get_animation">[docs]</a>    <span class="k">def</span> <span class="nf">get_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;animation&#39;</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Animation represents the time evolution of the intensity of the field.</span>
<span class="sd">            </span>
<span class="sd">        :param s: Default value 250. Area of each marker.</span>

<span class="sd">        :param fontsize: size of the font used for the axis labels and the title.</span>

<span class="sd">        :param save: Default value False. Save the figure in the repertory given</span>
<span class="sd">            by the method *dir_name* with name given by the method *file_name*.</span>

<span class="sd">        :param name: Default value &#39;animation&#39;. Name of the mp4 saved.</span>
<span class="sd">            </span>
<span class="sd">        .. note:: if size is too large (size_x and size_y &gt; 25)</span>
<span class="sd">            the resulting figure will not be so useful.</span>
<span class="sd">            </span>
<span class="sd">        Example usage::</span>
<span class="sd">            </span>
<span class="sd">            lieb = lieb_tb(sites_x=9, sites_y=9, t_x=[2., 2.], t_x=[2., 2.],\</span>
<span class="sd">                           e_a=0.5j, e_b=-0.5j, e_c=-0.5j)</span>
<span class="sd">            lieb.get_lattice_hop()</span>
<span class="sd">            # initial state uniformly distributed on all the sites</span>
<span class="sd">            psi_i = np.ones(lieb.sites)/lieb.sites</span>
<span class="sd">            lieb.propagation(psi_i)</span>
<span class="sd">            lieb.get_animation()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Run the method get_animation or get_pumping first.</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;posix&#39;</span><span class="p">:</span>
            <span class="n">blit</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">blit</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s">&#39;Time evolution&#39;</span><span class="p">)</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$i$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$j$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;$|\psi(z)|^2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">map_red</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&quot;Reds&quot;</span><span class="p">)</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coor_y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span>
                           <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">map_red</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">)])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">])</span>
        <span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update_plot</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">,</span>
                                      <span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_prop</span><span class="p">,</span> <span class="n">scat</span><span class="p">),</span>
                                      <span class="n">blit</span><span class="o">=</span><span class="n">blit</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">()</span>
            <span class="n">name_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#39;.mp4&#39;</span>
            <span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">name_file</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">extra_args</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;-vcodec&#39;</span><span class="p">,</span> <span class="s">&#39;libx264&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="lieb_tb.plt_show"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.plt_show">[docs]</a>    <span class="k">def</span> <span class="nf">plt_show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Duplicate the matplotlib method *show* to avoid importing matplotlib</span>
<span class="sd">        to plot on screen the figures generated by the **chain_tb** class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c">#############################################################</span>
    <span class="c"># NAME DIRECTORY FILE NAME DIRECTORY FILE NAME DIRECTORY FILE</span>
    <span class="c">#############################################################</span>
</div>
<div class="viewcode-block" id="lieb_tb.dir_name"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.dir_name">[docs]</a>    <span class="k">def</span> <span class="nf">dir_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the name of the directory, placed in &#39;./figs&#39;, in which the figures</span>
<span class="sd">        can be stored.</span>
<span class="sd">        </span>
<span class="sd">        The directory name contains the number of sites, the onsite energies</span>
<span class="sd">        and the hoppings of the A and B sublattices in complex valued notation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="s">&#39;figs/nx{}ny{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sites_ab_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites_ac_y</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_ta&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ab</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_tb&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ba</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_tc&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ac</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_td&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ca</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_ea&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_a</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_eb&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_b</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">+=</span> <span class="s">&#39;_ec&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e_c</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">directory</span>
</div>
<div class="viewcode-block" id="lieb_tb.check_dir"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.check_dir">[docs]</a>    <span class="k">def</span> <span class="nf">check_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the directory if it does not exist yet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s">&#39;figs&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s">&#39;figs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="lieb_tb.file_name"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.file_name">[docs]</a>    <span class="k">def</span> <span class="nf">file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the last part of the file containing: the indices (not the values)</span>
<span class="sd">        of the hopping defects (if any), the indices (not the values) of the onsite</span>
<span class="sd">        enery defects (if any), the indices of the dimerization defects (if any),</span>
<span class="sd">        and the file format extension.</span>

<span class="sd">        :returns:</span>
<span class="sd">            **name** -- last part of the file name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_hopDefx&#39;</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_x</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_hopDefy&#39;</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_hop_def_y</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_dimDefx&#39;</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_x</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_dimDefy&#39;</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_dim_def_y</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diag_strength</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_diag_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diag_strength</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_x</span> <span class="o">!=</span> <span class="mf">0.</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_y</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_dis_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_x</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_x&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_y</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_y&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dis_strength_y</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">name</span>
</div>
<div class="viewcode-block" id="lieb_tb.save_fig"><a class="viewcode-back" href="../code.html#lieb_tb.lieb_tb.save_fig">[docs]</a>    <span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">file_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the figure in the directory defined by the method *dir_name()*.</span>
<span class="sd">        Method essentially to be used by the methods plt_xxx</span>
<span class="sd">        </span>
<span class="sd">        :param fig: Matplotlib fig.</span>
<span class="sd">                    </span>
<span class="sd">        :param file_id: Fist part of the file describing more specifically the figure,</span>
<span class="sd">          the file_ids used in the class are: &#39;lattice, &#39;&#39;spectrum&#39;,</span>
<span class="sd">          &#39;spec_pola&#39;, &#39;density&#39;, and &#39;propagation&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">()</span>
        <span class="n">name_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">file_id</span> \
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">name_file</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="update_plot"><a class="viewcode-back" href="../code.html#lieb_tb.update_plot">[docs]</a><span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">scat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to build up the animation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scat</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">scat</span><span class="p">,</span>

</div>
<div class="viewcode-block" id="equations"><a class="viewcode-back" href="../code.html#lieb_tb.equations">[docs]</a><span class="k">def</span> <span class="nf">equations</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the intersection of the points at the extremity of two segments.</span>
<span class="sd">    Used to build up the lattice in hopping space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span>
    <span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">la</span><span class="p">,</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">param</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xa</span><span class="o">+</span><span class="n">la</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ta</span><span class="p">)</span><span class="o">-</span><span class="n">xb</span><span class="o">-</span><span class="n">lb</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">tb</span><span class="p">),</span>
            <span class="n">ya</span><span class="o">+</span><span class="n">la</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ta</span><span class="p">)</span><span class="o">-</span><span class="n">yb</span><span class="o">-</span><span class="n">lb</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">tb</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="hop_to_real_mw"><a class="viewcode-back" href="../code.html#lieb_tb.hop_to_real_mw">[docs]</a><span class="k">def</span> <span class="nf">hop_to_real_mw</span><span class="p">(</span><span class="n">hop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the sites position in real space from the hoppings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">4.5051e9</span> <span class="c">#GHz</span>
    <span class="n">ga</span> <span class="o">=</span> <span class="mf">0.8287e3</span> <span class="c">#mm1</span>
    <span class="n">de</span> <span class="o">=</span> <span class="mf">0.00584e9</span> <span class="c">#GHz</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="n">ga</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">hop</span><span class="o">-</span><span class="n">de</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="real_to_hop_mw"><a class="viewcode-back" href="../code.html#lieb_tb.real_to_hop_mw">[docs]</a><span class="k">def</span> <span class="nf">real_to_hop_mw</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the sites position in real space from the hoppings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">4.5051e9</span> <span class="c">#GHz</span>
    <span class="n">ga</span> <span class="o">=</span> <span class="mf">0.8287e3</span> <span class="c">#mm1</span>
    <span class="n">de</span> <span class="o">=</span> <span class="mf">0.00584e9</span> <span class="c">#GHz</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">ga</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">+</span><span class="n">de</span>
</pre></div></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Charles Poli.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>